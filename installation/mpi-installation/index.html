<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fast mutation counting and reactivity profiling for MaP-seq experiments">
      
      
      
        <link rel="canonical" href="https://hmblair.github.io/cmuts/installation/mpi-installation/">
      
      
        <link rel="prev" href="../basic-installation/">
      
      
        <link rel="next" href="../org-notes/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>MPI Installation - cmuts Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mpi-installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="cmuts Documentation" class="md-header__button md-logo" aria-label="cmuts Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            cmuts Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MPI Installation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/hmblair/cmuts" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    hmblair/cmuts
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../requirements/" class="md-tabs__link">
          
  
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usage/cmuts/" class="md-tabs__link">
          
  
  
  Usage

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="cmuts Documentation" class="md-nav__button md-logo" aria-label="cmuts Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    cmuts Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hmblair/cmuts" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    hmblair/cmuts
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Requirements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic-installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    MPI Installation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    MPI Installation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#when-to-use-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use MPI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-mpi-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Verify MPI Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-1-package-managers-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Method 1: Package Managers (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-2-stanford-sherlock" class="md-nav__link">
    <span class="md-ellipsis">
      Method 2: Stanford Sherlock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-with-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      Building with MPI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building with MPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-clone-repository" class="md-nav__link">
    <span class="md-ellipsis">
      1. Clone Repository
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-for-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configure for MPI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-verify-mpi-build" class="md-nav__link">
    <span class="md-ellipsis">
      3. Verify MPI Build
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpi-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      MPI Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdf5-parallel-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      HDF5 Parallel Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-mpi-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing MPI Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing MPI Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-mpi-test" class="md-nav__link">
    <span class="md-ellipsis">
      Basic MPI Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-test" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehensive-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive Test Suite
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-parallel-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Parallel Execution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-mpi-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common MPI Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdf5-parallel-io-issues" class="md-nav__link">
    <span class="md-ellipsis">
      HDF5 Parallel I/O Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimal-usage-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Optimal Usage Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimal Usage Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-count-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      Process Count Guidelines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-mpi-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Updating MPI Installation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../org-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Organization-Specific Notes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/cmuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cmuts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#when-to-use-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use MPI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-mpi-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Verify MPI Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-1-package-managers-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Method 1: Package Managers (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-2-stanford-sherlock" class="md-nav__link">
    <span class="md-ellipsis">
      Method 2: Stanford Sherlock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-with-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      Building with MPI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building with MPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-clone-repository" class="md-nav__link">
    <span class="md-ellipsis">
      1. Clone Repository
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configure-for-mpi" class="md-nav__link">
    <span class="md-ellipsis">
      2. Configure for MPI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-verify-mpi-build" class="md-nav__link">
    <span class="md-ellipsis">
      3. Verify MPI Build
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpi-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      MPI Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdf5-parallel-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      HDF5 Parallel Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-mpi-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing MPI Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing MPI Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-mpi-test" class="md-nav__link">
    <span class="md-ellipsis">
      Basic MPI Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-test" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehensive-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive Test Suite
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-parallel-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Parallel Execution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-mpi-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common MPI Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdf5-parallel-io-issues" class="md-nav__link">
    <span class="md-ellipsis">
      HDF5 Parallel I/O Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimal-usage-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Optimal Usage Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimal Usage Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-count-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      Process Count Guidelines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-mpi-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Updating MPI Installation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mpi-installation">MPI Installation</h1>
<p>This guide covers installing cmuts with MPI (Message Passing Interface) support for parallel processing. MPI installation enables cmuts to utilize multiple CPU cores and potentially multiple nodes for faster processing of large datasets.</p>
<h2 id="when-to-use-mpi">When to Use MPI</h2>
<p>Consider MPI installation if you have:</p>
<ul>
<li><strong>Large BAM/CRAM files</strong> (&gt;5 GB)</li>
<li><strong>Multiple files</strong> to process in batch</li>
<li><strong>Multi-core systems</strong> (8+ cores recommended)</li>
<li><strong>High-throughput</strong> analysis requirements</li>
<li><strong>Cluster computing</strong> environment available</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<h3 id="basic-dependencies">Basic Dependencies</h3>
<p>All <a href="../requirements/">basic installation requirements</a> plus:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>OpenMPI</strong></td>
<td>MPI implementation</td>
</tr>
<tr>
<td><strong>HDF5 with parallel support</strong></td>
<td>Parallel HDF5 I/O</td>
</tr>
</tbody>
</table>
<h3 id="verify-mpi-installation">Verify MPI Installation</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Check MPI installation</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>mpirun<span class="w"> </span>--version
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>mpicc<span class="w"> </span>--version
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Check parallel HDF5</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>h5pcc<span class="w"> </span>--version<span class="w">  </span><span class="c1"># Should be available if HDF5 has parallel support</span>
</code></pre></div>
<h2 id="installation-methods">Installation Methods</h2>
<h3 id="method-1-package-managers-recommended">Method 1: Package Managers (Recommended)</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><input id="__tabbed_1_3" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Homebrew (macOS)</label><label for="__tabbed_1_2">Ubuntu/Debian</label><label for="__tabbed_1_3">CentOS/RHEL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Install parallel HDF5 and OpenMPI</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>brew<span class="w"> </span>install<span class="w"> </span>hdf5-mpi<span class="w"> </span>open-mpi
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Verify installation</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>brew<span class="w"> </span>list<span class="w"> </span>hdf5-mpi
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>which<span class="w"> </span>mpirun
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Install MPI and parallel HDF5</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>openmpi-bin<span class="w"> </span>libopenmpi-dev<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">                 </span>libhdf5-openmpi-dev<span class="w"> </span>libhdf5-dev
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1"># Verify installation  </span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>dpkg<span class="w"> </span>-l<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">"(openmpi|hdf5)"</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Install MPI and parallel HDF5</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>openmpi<span class="w"> </span>openmpi-devel<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">                 </span>hdf5-openmpi<span class="w"> </span>hdf5-openmpi-devel
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1"># Load MPI module (if using modules)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>module<span class="w"> </span>load<span class="w"> </span>mpi/openmpi-x86_64
</code></pre></div>
</div>
</div>
</div>
<h3 id="method-2-stanford-sherlock">Method 2: Stanford Sherlock</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Load required modules</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>ml<span class="w"> </span>load<span class="w"> </span>openmpi/4.1.2
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>ml<span class="w"> </span>load<span class="w"> </span>hdf5/1.14.4<span class="w">  </span><span class="c1"># Ensure this has parallel support</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>ml<span class="w"> </span>load<span class="w"> </span>cmake/3.31.4
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>ml<span class="w"> </span>load<span class="w"> </span>biology<span class="w"> </span>samtools/1.16.1
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1"># Verify parallel HDF5</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>ml<span class="w"> </span>show<span class="w"> </span>hdf5<span class="w">  </span><span class="c1"># Should mention parallel or MPI support</span>
</code></pre></div>
<h2 id="building-with-mpi">Building with MPI</h2>
<h3 id="1-clone-repository">1. Clone Repository</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>git<span class="w"> </span>clone<span class="w"> </span>--recurse-submodules<span class="w"> </span>https://github.com/hmblair/cmuts
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nb">cd</span><span class="w"> </span>cmuts
</code></pre></div>
<h3 id="2-configure-for-mpi">2. Configure for MPI</h3>
<p>Run the configure script with the MPI flag:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>./configure<span class="w"> </span>--mpi
</code></pre></div>
<p>This will:</p>
<ul>
<li>Detect MPI compiler wrappers (<code>mpicc</code>, <code>mpicxx</code>)</li>
<li>Configure HDF5 with parallel support</li>
<li>Build cmuts with MPI threading capabilities</li>
<li>Enable parallel I/O optimizations</li>
</ul>
<h3 id="3-verify-mpi-build">3. Verify MPI Build</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Check that MPI version was built</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>file<span class="w"> </span>bin/cmuts<span class="w">  </span><span class="c1"># Should show it's dynamically linked</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>ldd<span class="w"> </span>bin/cmuts<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>mpi<span class="w">  </span><span class="c1"># Should show MPI libraries</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1"># Test MPI functionality</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">2</span><span class="w"> </span>bin/cmuts<span class="w"> </span>--help
</code></pre></div>
<h2 id="environment-configuration">Environment Configuration</h2>
<h3 id="mpi-environment-variables">MPI Environment Variables</h3>
<p>Set these for optimal performance:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Recommended MPI settings</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_btl_vader_single_copy_mechanism</span><span class="o">=</span>none
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_mpi_warn_on_fork</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c1"># For large datasets</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_io_romio_cb_read</span><span class="o">=</span><span class="nb">enable</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_io_romio_cb_write</span><span class="o">=</span><span class="nb">enable</span>
</code></pre></div>
<h3 id="hdf5-parallel-configuration">HDF5 Parallel Configuration</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Ensure HDF5 finds MPI</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">HDF5_CC</span><span class="o">=</span><span class="k">$(</span>which<span class="w"> </span>mpicc<span class="k">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">HDF5_CLINKER</span><span class="o">=</span><span class="k">$(</span>which<span class="w"> </span>mpicc<span class="k">)</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1"># For debugging HDF5 parallel I/O (optional)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">HDF5_DISABLE_VERSION_CHECK</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<h2 id="testing-mpi-installation">Testing MPI Installation</h2>
<h3 id="basic-mpi-test">Basic MPI Test</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Test with 4 processes</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>cmuts<span class="w"> </span>--help
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># Should output help message 4 times (one per process)</span>
</code></pre></div>
<h3 id="performance-test">Performance Test</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Run built-in performance tests</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>./tests/profile<span class="w"> </span>--mpi
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c1"># Compare single-threaded vs MPI performance</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="nb">time</span><span class="w"> </span>cmuts<span class="w"> </span>-o<span class="w"> </span>test.h5<span class="w"> </span>-f<span class="w"> </span>reference.fasta<span class="w"> </span>input.bam
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="nb">time</span><span class="w"> </span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">8</span><span class="w"> </span>cmuts<span class="w"> </span>-o<span class="w"> </span>test_mpi.h5<span class="w"> </span>-f<span class="w"> </span>reference.fasta<span class="w"> </span>input.bam
</code></pre></div>
<h3 id="comprehensive-test-suite">Comprehensive Test Suite</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Run tests with MPI</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>./tests/run<span class="w"> </span>--mpi
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Should show successful completion of all test cases</span>
</code></pre></div>
<h2 id="usage-examples">Usage Examples</h2>
<h3 id="basic-parallel-execution">Basic Parallel Execution</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Use 8 MPI processes</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">8</span><span class="w"> </span>cmuts<span class="w"> </span>-o<span class="w"> </span>output.h5<span class="w"> </span>-f<span class="w"> </span>reference.fasta<span class="w"> </span>input.bam
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c1"># Process multiple files in parallel</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">8</span><span class="w"> </span>cmuts<span class="w"> </span>-o<span class="w"> </span>output.h5<span class="w"> </span>-f<span class="w"> </span>reference.fasta<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span>file1.bam<span class="w"> </span>file2.bam<span class="w"> </span>file3.bam
</code></pre></div>
<h3 id="cluster-usage">Cluster Usage</h3>
<p>For SLURM-based clusters:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1">#SBATCH --job-name=cmuts_analysis</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1">#SBATCH --nodes=2</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1">#SBATCH --ntasks-per-node=16</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1">#SBATCH --time=04:00:00</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1">#SBATCH --mem=64G</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>module<span class="w"> </span>load<span class="w"> </span>openmpi<span class="w"> </span>hdf5<span class="w"> </span>samtools
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>mpirun<span class="w"> </span>cmuts<span class="w"> </span>-o<span class="w"> </span>results.h5<span class="w"> </span>-f<span class="w"> </span>reference.fasta<span class="w"> </span>large_dataset.bam
</code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-mpi-issues">Common MPI Issues</h3>
<div class="admonition failure">
<p class="admonition-title">MPI not found during configure</p>
<p><strong>Solution</strong>: Ensure MPI is in PATH and try explicit paths
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="k">$(</span>which<span class="w"> </span>mpicc<span class="k">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CXX</span><span class="o">=</span><span class="k">$(</span>which<span class="w"> </span>mpicxx<span class="k">)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>./configure<span class="w"> </span>--mpi
</code></pre></div><p></p>
</div>
<div class="admonition failure">
<p class="admonition-title">HDF5 lacks parallel support</p>
<p><strong>Error</strong>: <code>HDF5 was not built with parallel I/O support</code></p>
<p><strong>Solution</strong>: Install HDF5 with MPI support
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Homebrew</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>brew<span class="w"> </span>uninstall<span class="w"> </span>hdf5
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>brew<span class="w"> </span>install<span class="w"> </span>hdf5-mpi
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># Ubuntu</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libhdf5-openmpi-dev
</code></pre></div><p></p>
</div>
<div class="admonition failure">
<p class="admonition-title">Runtime MPI errors</p>
<p><strong>Error</strong>: <code>ORTE_ERROR_LOG: Not found</code></p>
<p><strong>Solution</strong>: Check MPI installation and PATH
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>which<span class="w"> </span>mpirun
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>mpirun<span class="w"> </span>--version
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="nb">echo</span><span class="w"> </span><span class="nv">$PATH</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-o<span class="w"> </span>mpi
</code></pre></div><p></p>
</div>
<h3 id="performance-issues">Performance Issues</h3>
<div class="admonition warning">
<p class="admonition-title">Poor scaling</p>
<p>If MPI doesn't improve performance:</p>
<ul>
<li><strong>Check I/O bottlenecks</strong>: Use SSD storage</li>
<li><strong>Optimize process count</strong>: Try <code>nproc / 2</code> processes</li>
<li><strong>Check memory usage</strong>: Each process needs adequate RAM</li>
<li><strong>Profile with</strong>: <code>./tests/profile --mpi -np 4,8,16</code></li>
</ul>
</div>
<h3 id="hdf5-parallel-io-issues">HDF5 Parallel I/O Issues</h3>
<div class="admonition info">
<p class="admonition-title">Debugging HDF5 parallel problems</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Enable HDF5 debug output</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">HDF5_DEBUG</span><span class="o">=</span>all
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>cmuts<span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1"># Check HDF5 parallel capabilities</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>h5pcc<span class="w"> </span>-showconfig<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>parallel
</code></pre></div>
</div>
<h2 id="optimal-usage-patterns">Optimal Usage Patterns</h2>
<h3 id="process-count-guidelines">Process Count Guidelines</h3>
<table>
<thead>
<tr>
<th>Dataset Size</th>
<th>Recommended Processes</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt; 1 GB</td>
<td>2-4 processes</td>
</tr>
<tr>
<td>1-10 GB</td>
<td>4-8 processes</td>
</tr>
<tr>
<td>10-50 GB</td>
<td>8-16 processes</td>
</tr>
<tr>
<td>&gt; 50 GB</td>
<td>16-32 processes</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Process Count Selection</p>
<p>Start with <code>min(file_size_GB, num_cores)</code> processes and adjust based on performance.</p>
</div>
<h3 id="memory-considerations">Memory Considerations</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Monitor memory usage</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">8</span><span class="w"> </span>cmuts<span class="w"> </span>--chunk-size<span class="w"> </span><span class="m">64</span><span class="w"> </span>-o<span class="w"> </span>output.h5<span class="w"> </span>-f<span class="w"> </span>ref.fasta<span class="w"> </span>input.bam
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c1"># For memory-constrained systems</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>cmuts<span class="w"> </span>--low-mem<span class="w"> </span>--chunk-size<span class="w"> </span><span class="m">32</span><span class="w"> </span>...
</code></pre></div>
<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="recommended-settings">Recommended Settings</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Optimized MPI execution</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span>--map-by<span class="w"> </span>core<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span>--bind-to<span class="w"> </span>core<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span>cmuts<span class="w"> </span>-o<span class="w"> </span>output.h5<span class="w"> </span>-f<span class="w"> </span>reference.fasta<span class="w"> </span>input.bam<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span>--chunk-size<span class="w"> </span><span class="m">256</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">    </span>--no-insertions<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">    </span>--filter-coverage
</code></pre></div>
<h3 id="io-optimization">I/O Optimization</h3>
<ul>
<li><strong>Use SSD storage</strong> for input and output files</li>
<li><strong>Place temporary files</strong> on local fast storage</li>
<li><strong>Avoid network filesystems</strong> for intensive I/O when possible</li>
</ul>
<h2 id="next-steps">Next Steps</h2>
<p>With MPI cmuts installed:</p>
<ol>
<li><strong><a href="../development/performance.md">Performance Testing</a></strong> - Benchmark your installation</li>
<li><strong><a href="../usage/advanced.md">Advanced Usage</a></strong> - Explore parallel processing options</li>
<li><strong><a href="../usage/cluster.md">Cluster Integration</a></strong> - Deploy on computing clusters</li>
<li><strong><a href="../usage/optimization.md">Optimization Guide</a></strong> - Tune performance parameters</li>
</ol>
<h2 id="updating-mpi-installation">Updating MPI Installation</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nb">cd</span><span class="w"> </span>cmuts
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>git<span class="w"> </span>pull<span class="w"> </span>origin<span class="w"> </span>main
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--recursive
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1"># Clean build for MPI</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>rm<span class="w"> </span>-rf<span class="w"> </span>build/<span class="w"> </span>bin/
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>./configure<span class="w"> </span>--mpi
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>